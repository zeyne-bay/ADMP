library(sparklyr)
library(tidyverse)
library(dplyr)
library(readxl)
library(readr)


sc <- spark_connect(master = "spark://HOST:PORT")
connection_is_open(sc)

#Importing Stop and Search Data
S2017_03 <- read_csv("Merge/2017-03-south-yorkshire-stop-and-search.csv")
S2017_04 <- read_csv("Merge/2017-04-south-yorkshire-stop-and-search.csv")
S2017_05 <- read_csv("Merge/2017-05-south-yorkshire-stop-and-search.csv")
S2017_06 <- read_csv("Merge/2017-06-south-yorkshire-stop-and-search.csv")
S2017_07 <- read_csv("Merge/2017-07-south-yorkshire-stop-and-search.csv")
S2017_08 <- read_csv("Merge/2017-08-south-yorkshire-stop-and-search.csv")
S2017_09 <- read_csv("Merge/2017-09-south-yorkshire-stop-and-search.csv")
S2017_10 <- read_csv("Merge/2017-10-south-yorkshire-stop-and-search.csv")
S2017_11 <- read_csv("Merge/2017-11-south-yorkshire-stop-and-search.csv")
S2017_12 <- read_csv("Merge/2017-12-south-yorkshire-stop-and-search.csv")

S2018_01 <- read_csv("Merge/2018-01-south-yorkshire-stop-and-search.csv")
S2018_02 <- read_csv("Merge/2018-02-south-yorkshire-stop-and-search.csv")
S2018_03 <- read_csv("Merge/2018-03-south-yorkshire-stop-and-search.csv")
S2018_04 <- read_csv("Merge/2018-04-south-yorkshire-stop-and-search.csv")
S2018_05 <- read_csv("Merge/2018-05-south-yorkshire-stop-and-search.csv")
S2018_06 <- read_csv("Merge/2018-06-south-yorkshire-stop-and-search.csv")
S2018_07 <- read_csv("Merge/2018-07-south-yorkshire-stop-and-search.csv")
S2018_08 <- read_csv("Merge/2018-08-south-yorkshire-stop-and-search.csv")
S2018_09 <- read_csv("Merge/2018-09-south-yorkshire-stop-and-search.csv")
S2018_10 <- read_csv("Merge/2018-10-south-yorkshire-stop-and-search.csv")
S2018_11 <- read_csv("Merge/2018-11-south-yorkshire-stop-and-search.csv")
S2018_12 <- read_csv("Merge/2018-12-south-yorkshire-stop-and-search.csv")

S2019_01 <- read_csv("Merge/2019-01-south-yorkshire-stop-and-search.csv")
S2019_02 <- read_csv("Merge/2019-02-south-yorkshire-stop-and-search.csv")
S2019_03 <- read_csv("Merge/2019-03-south-yorkshire-stop-and-search.csv")
S2019_04 <- read_csv("Merge/2019-04-south-yorkshire-stop-and-search.csv")
S2019_05 <- read_csv("Merge/2019-05-south-yorkshire-stop-and-search.csv")
S2019_06 <- read_csv("Merge/2019-06-south-yorkshire-stop-and-search.csv")
S2019_07 <- read_csv("Merge/2019-07-south-yorkshire-stop-and-search.csv")
S2019_08 <- read_csv("Merge/2019-08-south-yorkshire-stop-and-search.csv")
S2019_09 <- read_csv("Merge/2019-09-south-yorkshire-stop-and-search.csv")
S2019_10 <- read_csv("Merge/2019-10-south-yorkshire-stop-and-search.csv")
S2019_11 <- read_csv("Merge/2019-11-south-yorkshire-stop-and-search.csv")
S2019_12 <- read_csv("Merge/2019-12-south-yorkshire-stop-and-search.csv")

S2020_01 <- read_csv("Merge/2020-01-south-yorkshire-stop-and-search.csv")
S2020_02 <- read_csv("Merge/2020-02-south-yorkshire-stop-and-search.csv")


StopSearch <- (S2017_03)
View(StopSearch)

#binding the rest of Datasets to StopSearch

StopSearch <- rbind(StopSearch,S2017_04)
StopSearch <- rbind(StopSearch,S2017_05)
StopSearch <- rbind(StopSearch,S2017_06)
StopSearch <- rbind(StopSearch,S2017_07)
StopSearch <- rbind(StopSearch,S2017_08)
StopSearch <- rbind(StopSearch,S2017_09)
StopSearch <- rbind(StopSearch,S2017_10)
StopSearch <- rbind(StopSearch,S2017_11)
StopSearch <- rbind(StopSearch,S2017_12)
StopSearch <- rbind(StopSearch,S2018_01)
StopSearch <- rbind(StopSearch,S2018_02)
StopSearch <- rbind(StopSearch,S2018_03)
StopSearch <- rbind(StopSearch,S2018_04)
StopSearch <- rbind(StopSearch,S2018_05)
StopSearch <- rbind(StopSearch,S2018_06)
StopSearch <- rbind(StopSearch,S2018_07)
StopSearch <- rbind(StopSearch,S2018_08)
StopSearch <- rbind(StopSearch,S2018_09)
StopSearch <- rbind(StopSearch,S2018_10)
StopSearch <- rbind(StopSearch,S2018_11)
StopSearch <- rbind(StopSearch,S2018_12)
StopSearch <- rbind(StopSearch,S2019_01)
StopSearch <- rbind(StopSearch,S2019_02)
StopSearch <- rbind(StopSearch,S2019_03)
StopSearch <- rbind(StopSearch,S2019_04)
StopSearch <- rbind(StopSearch,S2019_05)
StopSearch <- rbind(StopSearch,S2019_06)
StopSearch <- rbind(StopSearch,S2019_07)
StopSearch <- rbind(StopSearch,S2019_08)
StopSearch <- rbind(StopSearch,S2019_09)
StopSearch <- rbind(StopSearch,S2019_10)
StopSearch <- rbind(StopSearch,S2019_11)
StopSearch <- rbind(StopSearch,S2019_12)
StopSearch <- rbind(StopSearch,S2020_01)
StopSearch <- rbind(StopSearch,S2020_02)

View(StopSearch)
